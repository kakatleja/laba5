Отчет по лабораторной работе №5
Мусин Артур

Тема: Работа с Excel-файлами и LINQ-запросы в C#

1.1 Client

Свойства: Id, LastName, FirstName, Patronymic, City

Конструктор: принимает все свойства, убирает префикс "г. " из города

Метод: ToString() → "Клиент Id: Фамилия Имя Отчество, город City"

Пример:
Клиент 1: Иванов Иван Иванович, город Владивосток
Клиент 2: Петров Петр Петрович, город Москва

1.2 Order

Свойства: Id, ClientId, ServiceId, Date, Quantity

Конструктор: инициализирует все свойства

Метод: ToString() → "Заказ Id: клиент ClientId, услуга ServiceId, дата Date, кол-во Quantity"

Пример:
Заказ 1: клиент 1, услуга 2, дата 17.12.2025, кол-во 10
Заказ 2: клиент 2, услуга 3, дата 18.12.2025, кол-во 5

1.3 Service

Свойства: Id, TypeId, Name, Price

Конструктор: парсит цену из строки формата "123 р."

Метод: ToString() → "Услуга Id: Name, цена Price р."

Пример:
Услуга 1: Печать, цена 150 р.
Услуга 2: Ламинирование, цена 200 р.

1.4 ServiceType

Свойства: Id, Name

Конструктор: инициализирует Id и Name

Метод: ToString() → "Тип услуги Id: Name"

Пример:
Тип услуги 1: Полиграфия
Тип услуги 2: Дизайн

2. Алгоритмы и примеры работы по пунктам интерфейса

Пункт 1 – Просмотр листа

Метод: DataManager.ShowSheet(sheetName)

Алгоритм:
Определяем коллекцию по названию листа.
Проходим по элементам и выводим ToString().
Если лист не найден – выводим сообщение.

Пример:
Ввод: Клиенты
Вывод:
Клиент 1: Иванов Иван Иванович, город Владивосток
Клиент 2: Петров Петр Петрович, город Москва

Ввод: Заказы
Вывод:
Заказ 1: клиент 1, услуга 2, дата 17.12.2025, кол-во 10
Заказ 2: клиент 2, услуга 3, дата 18.12.2025, кол-во 5

Пункт 2 – Добавить элемент в лист

Метод: DataManager.AddToSheet(sheetName, params string[] values)

Алгоритм:
Определяем лист.
Создаем объект соответствующего класса из значений.
Добавляем объект в коллекцию.

Сообщаем об успешном добавлении.

Пример:
Ввод:
Лист: Клиенты
Значения: 3, Сидоров, Сидор, Сидорович, Санкт-Петербург

Вывод:
Элемент добавлен в коллекцию. Не забудьте сохранить изменения в Excel.

Пункт 3 – Удалить элемент по Id

Метод: DataManager.RemoveById(sheetName, id)

Алгоритм:
Определяем коллекцию.
Удаляем элемент с заданным Id.
Сообщаем результат.

Пример:
Ввод:
Лист: Клиенты
Id: 2
Вывод:
Элемент удалён.

Если Id не найден:
Элемент с таким Id не найден.

Пункт 4 – LINQ-запрос: клиенты из города

Метод: DataManager.QueryClientsFromCity(city)

Алгоритм:
Отфильтровать клиентов по городу.
Вывести список ToString().

Пример:
Ввод: Владивосток
Вывод:
Клиент 1: Иванов Иван Иванович, город Владивосток

Пункт 5 – LINQ-запрос: количество заказов клиента

Метод: DataManager.QueryOrdersCountByClient()

Алгоритм:
Ввести ClientId.
Посчитать количество заказов.
Вывести результат.

Пример:
Ввод: 1
Вывод:
Количество заказов: 3

Пункт 6 – LINQ-запрос: заказы + услуги

Метод: DataManager.QueryOrdersWithServices()

Алгоритм:
Объединить orders, clients, services по ключам.
Вывести OrderId, фамилию клиента, название услуги, сумму (Price * Quantity).

Пример:
Заказ 1 | Иванов | Печать | 1500
Заказ 2 | Петров | Ламинирование | 1000

Пункт 7 – LINQ-запрос: стоимость Полиграфии

Метод: DataManager.QueryPolygraphySum()

Алгоритм:
Фильтруем заказы по:
Город = Владивосток
Тип услуги = Полиграфия
Дата в заданном диапазоне
Считаем сумму (Price * Quantity)
Выводим результат

Пример:
Общая стоимость: 4500

Пункт 8 – Сохранить изменения в Excel

Метод: DataManager.SaveToExcel()

Алгоритм:
Открываем Excel-файл.
Очищаем старые данные на листах.
Записываем текущие коллекции в Excel.
Применяем форматирование (даты, цены).
Сохраняем файл.

Пример:
Изменения сохранены в Excel.
